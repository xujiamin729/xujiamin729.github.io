---
layout:	post
title:	简单批处理之一切尽在at中
categories:
- TECHNOLOGY
tags:
- Batch
permalink:  Summary-at-Batch
comments:	true
---
让计算机在自己规定的时间里干自己规定的事，一切尽在计划之中。所以at命令你一定不能错过。
<!-- more -->


## 概述
列出在指定的时间和日期在计算机上运行的已计划命令或计划命令和程序，以及设置在指定时间和日期在计算机上运行计划命令或程序（必须确保你的系统Task Scheduler服务是开启的）


## 用法

* Usage:

	```batch
	at  [\\computername] [ [id] [/DELETE] | /DELETE [/YES]]
	at  [\\computername] time [/INTERACTIVE] [ /EVERY:date[,...] | /NEXT:date[,...]] "command"
	```
* Parameter:  
	> \\computername    指定远程计算机。 如果省略这个参数，会计划在本地计算机上运行命令  
	> id                指定给已计划命令的识别号  
	> /delete           删除某个已计划的命令。如果省略id，计算机上所有已计划的命令都会被删除
	> /yes              不需要进一步确认时，跟删除所有作业的命令一起使用  
	> time              指定运行命令的时间。将时间以 24 小时标记(00:00 [午夜] 到 23:59)的方式表示为小时：分钟  
	> /interactive      允许作业在运行时，与当时登录的用户桌面进行交互  
	> /every:date[,...] 在每个星期或月的指定日期（例如每个星期四，或每月的第三天）运行命令。将 date指定为星期的一天或多天(M,T,W,Th,F,S,Su)，或月的一天或多天（使用1 到 31 的数字）。用逗号分隔多个日期项。如果省略了date，将假定为该月的当前日期   
	> "command"        准备运行的 Windows NT 命令或批处理程序


## 案例

1. 凌晨自动关机

	```batch
	at 00:00 shutdown -s -f -t 0 >nul 2>nul
	rem 0>nul 2>nul  表示无论命令执行成功与否都不显示消息
	```
2. 在每个周二的上午8点执行系统垃圾的清理(clean.exe)

	```batch
	at 8:00 /every:M cmd /c  d:/clean.bat  
	at 8:00 /every:M clean.exe
	rem    cmd /c dir 是执行完dir命令后关闭命令窗口
	rem    d:/clean.bat是你要执行垃圾清理的批处理的路径及文件名
	```
3. 计划从周一到周六每天上午2:00执行数据库备份

	```batch
	at 2:00 /every:M,T,W,TH,F,S,Su cmd /c d:autobackup.bat
	```
4. 计划管理

	```batch
	rem 列出当前所有计划
	at

	rem 取消所有计划
	at /del /yes

	rem 取消单个计划,如id为2
	at 2 /del
	```
