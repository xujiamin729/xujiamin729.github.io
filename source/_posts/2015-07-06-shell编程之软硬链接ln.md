---
layout:	post
title:	shell编程之软硬链接ln
categories:
- TECHNOLOGY
tags:
- Shell
permalink:  Explore-ln-Shell
comments:	true
---
在windows里面我们经常通过快捷方式来创建链接以方便我们使用电脑。而linux中有两种方式创建链接，分别为软链接和硬链接。下面我们就来详细说下二者的区别。
<!-- more -->


## 定义
`ln`命令是为某个文件在另外一个位置建立一个同步链接，当我们需要在不同的目录用到相同的文件时，我们不需要在每一个需要的目录下都放一个必须相同的文件，此时只需用`ln`创建对应文件的链接，不必重复的占用磁盘空间。

* 命令格式

	```bash
	# 硬链接
	ln source target
	# 软链接
	ln -s source target
	```
* 软链接

	软链接跟windows里面的快捷方式等价。它的内容是指向另一个文件的位置。所以可以创建某个目录的软链接，也可以对一个不存在的文件进行链接。除此之外，它可以跨文件系统。这三点硬链接都无法实现。
* 硬链接

	硬链接可以理解为文件的别名，而且别名可以有多个。

## 原理
对于linux而言，文件的结构与windows有点类似，由文件名，inode（类似于windows下的FCB文件控制块，保存文件的一些信息）和数据组成。比如创建origin文件，会得到下面的信息。
![origin]({{ site.baseurl }}/assets/images/origin.png)

注意Inode和硬链接，下面创建origin的硬链接hardlink。
![hardlink]({{ site.baseurl }}/assets/images/hardlink.png)

比对发现，创建硬链接的文件hardlink与原文件origin之间除了名称不同之外其他完全相同，就像同一个人它有个正式的名称也可能会有小名。它们的数据显然完全一样。

接下来，我们创建origin的软链接softlink。
![softlink]({{ site.baseurl }}/assets/images/softlink.png)

对比发现，origin和softlink是完全不同的文件，有着不同的size，不同的块，不同的Inode，不同的type。唯一的联系是softlink文件指向origin文件。


## 用例
*  删除源文件对软硬链接的影响
	![rmorigin]({{ site.baseurl }}/assets/images/rmorigin.png)

	由上图可以看出hardlink中硬链接的个数少了一个，而softlink还是安然无恙的存在着。接着我们通过两个链接来打开文件。
	![linkshow]({{ site.baseurl}}/assets/images/linkshow.png)

	由上图发觉，hardlink依旧能打开文件，而软链接却无法查看原文件。
