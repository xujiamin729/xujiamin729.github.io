---
layout:		post
title:		ML之线性回归
categories:
- TECHNOLOGY
tags:
- ML
- Algorithm
permalink:  Explore-LR-ML
comments:	true
---
线性回归[Line Regression]估计是我们接触最早的机器学习的算法了，差不过在高中的时候我们就会做一类题：就是给定xy坐标上的一些点（一般是线性的），然后用$y=ax+b$进行拟合，最后求出一个$(a,b)$以及y的预测值$\hat{y}$。其中$y=ax+b$在ML中叫模型，$(a,b)$叫模型参数（回归系数），或者特征x的权重，而y就是结果或标签，求解模型的方法叫最小二乘法[Ordinary Least Square Estimation]。本文将结合sklearning详细介绍一下线性回归方法。
<!-- more -->

## 概念理解
线性归是统计学里方法，“回归”一词的由来见下面的Tips。在统计学中，[线性回归][wiki_line_regression]是确定因变量$y$和一个或多个自变量$X$之间线性关系的统计分析方法。当自变量只有一个时叫简单线性回归，当自变量有多个时叫多维/多元线性回归（与多变量线性回归的区别见QA1）。

> **Tips:回归的由来**  
> 回归的方法是由达尔文的表兄弟Francis Galton发明的。Galton于这年完成了第一次回归预测，目的是根据上一代豌豆种子（双亲）的尺寸来预测下一代豌豆种子（孩子）的尺寸。他注意到如果双亲的高度比平均高度高，它们的子女也倾向于比平均高度高，但尚不及双亲。孩子的高度向着平均高度回退（回归）。Galton在多项研究上都注意到这个现象，所以尽管这个英文单词跟数值预测没有任何关系，但这种研究方法仍被称为回归。


### 回归vs分类
谈及回归，不可避免的谈到分类，这两个概念很相似，只不过分类的结果是1,2,3这样的离散型，而回归的结果却是连续型。二者都可以用来预测。

## 问题描述
给定一个随机样本集$(Y,X)$，$Y = [y_1, \cdots, y_n]^T$，$X = [X_1, \cdots, X_n]^T$，$X_i=[1, x_{i1}, \cdots, x_{id}]$，其中ｎ是样本集的个数，ｄ是样本的维度．线性回归模型就是寻找这样的回归系数$W=[w_0, w_1, \cdots, w_d]^T$，使得代价函数$J(W)$尽可能的小．一般将平方误差作为代价，此时
$$
J(W)  =  (Y-XW)^T \* (Y-XW)
      =  \sum_{i=1}^n (y_i - X_i*W)
$$

这里求代价函数$J(W)$最小值，可以通过对$W$求导，得到$X^T*(Y-XW)$，令其等于0，解出$W$如下：
$$
W=(X^T X)^{-1} X^T Y
$$
其具体的推导过程见下面的附录－多元线性回归的推导过程．

> **Tips:**  
> 上述公式中包含$(X^T X)^{-1}$，也就是说要对矩阵求逆，所以这个方程只在逆矩阵存在的时候适用的。因此必须要在代码中对此作出判断。
>




## kdfjs


## 问题&回答
1. Q：多维线性回归和多变量线性回归的区别  
A：该回答参考[这篇英文博文][multiple_vs_multivariate]。  
    * 差异性  
    该问题和线性没有关系。多维回归是指回归模型拥有一个因变量和多个自变量，而多变量回归是指回归模型拥有多个因变量和多个自变量。二者的区别是在于因变量的个数。
    * 联系  
    多变量回归可以由多个多维回归模型构成。
    * 举例说明  
    多变量回归一般用于解决系数的混合检验问题。比如，你想要知道SAT的各项分数对第一学年和第二学年有什么样的影响。一种方法是运行两个简单回归模型，并且查看系数是否相似;另一种方法是运行一个多变量回归模型，而且这种方式是正规的概率检验方式。虽然系数是一样的，但是后续你可以计算它们的相似度和其他属性等。

## 参考文献
1. [线性回归wiki][wiki_line_regression]
2. [多维线性回归vs多变量线性回归][multiple_vs_multivariate]
1. [机器学习实战][meachine_learning_70]

[wiki_line_regression]:  https://en.wikipedia.org/wiki/Linear_regression
[multiple_vs_multivariate]:  http://www.answers.com/Q/What_is_difference_between_multivariate_regression_and_multipal_regression
[meachine_learning_70]:  http://share.weiyun.com/f33d5770eba223764845beddf0d6bc09


## 附录
### 多元线性回归的推导过程
