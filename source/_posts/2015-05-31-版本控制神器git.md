---
layout:	post
title:	版本控制神器git
categories:
- TECHNOLOGY
tags:
- Git
- Ubuntu
permalink:  Explore-git
comments:	true
---
当使用git管理代码,有github帐号,至少有一个自己创建的项目出现在求职的综合加分项里时,了解git,github就应该成为一项立即,马上,现在去做的事.
<!-- more -->


## Git简介
Git是一个免费的、分布式的版本控制工具，或是一个强调了速度快的源代码管理工具。每一个Git的工作目录都是一个完全独立的代码库，并拥有完整的历史记录和版本追踪能力，不依赖于网络和中心服务器。


Git 在管理项目时，在本地会有三个工作区域：Git 的本地数据目录，工作目录以及暂存区域。如下图所示：![git-three-workspace]({{ site.baseurl }}/assets/images/git-three-workspace.png).

因此对于任何一个文件，在 Git 内都只有三种状态：已提交（committed），已修改（modified）和已暂存（staged）。

## GitHub简介
GitHub是一个利用Git提供免费的代码托管服务的网站（类似的网站还有老牌的SourceForge），很多著名的项目都托管在上面。说白一点就是将Git的本地数据库同步到GitHub网站上。用户一般通过公钥认证的方式连接到GitHub的SSH服务器.

## Git\&GitHub的结合
Git命令的实际操作图:
![git-github]({{ site.baseurl }}/assets/images/git-github.jpg)

图中**workspace**代表当前工作目录,**index**代表暂存区域，也叫索引,**Repository**代表本地仓库,而**Remote**代表远程服务器上的数据仓库，这里一般指GitHub网站的服务器.

## Git远程操作详解
* `git clone`	从远程主机克隆一个版本库

	```bash
	# 用法 从版本库的网址上拷贝文件到本地文件夹
	git clone <版本库的网址> <本地目录名>
	# 用例 支持多种文件协议
	git clone http[s]://example.com/path/to/repo.git/  # http协议
	git clone ssh://example.com/path/to/repo.git/      # ssh协议
	git clone git://example.com/path/to/repo.git/      # git协议
	git clone /opt/git/project.git                     # 本地文件
	git clone file:///opt/git/project.git              # 本地文件
	git clone ftp[s]://example.com/path/to/repo.git/   # ftp协议
	git clone rsync://example.com/path/to/repo.git/    # rsync协议
	```
* `git remote`	管理远程主机名

	```bash
	# 用法
	git remote add <主机名> <网址>    # 添加远程主机名
	git remote rm <主机名>           # 删除远程主机名
	git remote rename <原主机名> <新主机名>   # 更改原主机名
	git remote show <主机名>         # 显示主机名的详细信息
	```
* `git fetch`	将远程主机的版本库更新取回本地==[clone是从无到有,fetch是从有到有]==

	```bash
	git fetch <主机名> <分支名>
	```
* `git branch/checkout/merge/rebase`	管理分支

	```bash
	# 用法 查看分支情况
	git branch -r    # 查看远程分支
	git branch -a    # 查看所有分支，远程分支以remotes/开头
	# 用法 创建新分支
	git checkout -b newBranch origin/master   # 在origin/master的基础上创建新分支
	# 用法 合并分支
	git merge origin/master      # 将origin/master分支合并到本地分支
	git rebase origin/master
	```
* `git pull`	取回远程主机某个分支的更新，再与本地的指定分支合并

	```bash
	git pull <远程主机名> <远程分支名>:<本地分支名>
	# 等价于
	git fetch <远程主机名> <远程分支名>
	git merge <远程主机名>/<远程分支名>
	```
* `git push`	将本地分支的更新,推送到远程主机

	```bash
	git push <远程主机名> <本地分支名>:<远程分支名>
	```

## ubuntu下安装
* 安装git

	```bash
	sudo apt-get install git
	```
* 配置SSH Keys

	```bash
	# 以haojunyu2012@gmail.com创建ssh key，并将私钥保存在github文件中，公钥保存在github.pub文件中
	ssh-keygen -C "haojunyu2012@gmail.com" -f ~/.ssh/github
	```
* 配置GitHub  
登录自己的GitHub,依次点击Settings=>SSH keys=>Add SSH key,将github.pub中的公钥添加进去.
* 验证成功

	```bash
	# 执行命令
	ssh -T git@github.com
	# 提示
	Hi haojunyu! You've successfully authenticated, but GitHub does not provide shell access.
	```
* 配置git的个人信息

	```bash
	# 设置用户名
	git config --global user.name "haojunyu"
	# 设置email邮箱
	git config --global user.email "haojunyu2012@gmail.com"
	```

## ubuntu下使用
* 为已有的项目[project]创建代码仓库[repository]

	```bash
	# 在项目[project]的根目录执行以下命令

	# 创建README.md文件
	echo "# NLP" >> README.md
	# 创建一个空的git版本库[.git文件夹]
	git init
	# 添加所有文件到暂存区域
	git add *
	# 将暂存区域文件提交到本地仓库，并标注信息“initial project”
	git commit -m "initial project"
	# 添加远程主机名origin，它代表网址“https://github.com/haojunyu/SHELL.git”
	git remote add origin https://github.com/haojunyu/SHELL.git
	# 将本地的master分支推送到origin主机上的master分支，并设定origin为默认主机
	git push -u origin master
	```
* 从远程服务器上克隆一个仓库到本地

	```bash
	# 从https://github.com/haojunyu上克隆SHELL.git到本地shell文件夹
	git clone https://github.com/haojunyu/SHELL.git shell
	```
* 忽略某些文件或文件夹
有些文件无需纳入 Git 的管理,也不希望它们总出现在未跟踪文件列表。通常都是些自动生成的文件,像是日志或者编译过程中创建的等等。可以创建.gitignore文件来屏蔽这些

	```bash
	# 此为注释 – 将被 Git 忽略
	*.a        # 忽略所有 .a 结尾的文件
	!lib.a     # 但 lib.a 除外
	/TODO      # 仅仅忽略项目根目录下的 TODO 文件,不包括 subdir/TODO
	build/     # 忽略 build/ 目录下的所有文件
	doc/*.txt  # 会忽略 doc/notes.txt， 但不包括 doc/server/arch.txt
	```
* 查看提交的更新

	```bash
	# 查看提交的日志，并显示最近两次提交更新区别
	git log -p -2
	```
	> **选项说明**  
	> `-p`	按补丁格式显示每个更新之间的差异。  
	> `--stat`	显示每次更新的文件修改统计信息。  
	> `--shortstat`	只显示 --stat 中最后的行数修改添加移除统计  。  
	> `--pretty`				使用其他格式显示历史提交信息。可用的选项包括 oneline,short,full,fuller 和 format(后跟指定格式)。  
* 存储当前工作空间
储藏（stashing）可以获取你工作目录的中间状态——也就是你修改过的被追踪的文件和暂存的变更——并将它保存到一个未完结变更的堆栈中,随时可以重新应用。

	```bash
	# 存储当前工作空间，以方便进行切换
	git stash
	# 此时工作空间所有文件的状态就干净了,可以切换到其他工作空间

	# 显示之前存储的工作空间
	git stash list

	# 重新启用存储的工作空间
	git stash apply stash@2

	# 移除存储的工作空间
	git stash drop stash@2

	# 从存储中创建分支
	git stash branch testchanges
	```

## Git文件结构
* 文件夹：
	* `branches`
	* `hooks`	客户端或服务端钩子脚本
	* `info`	保存了一份不希望在 .gitignore 文件中管理的忽略模式 (ignored patterns) 的全局
* 可执行文件
	* `refs`	存储指向数据 (分支) 的提交对象的指针
	* `objects`	存储所有数据内容
* 文件
	* `HEAD`	指向当前分支
	* `config`	包含了项目特有的配置选项
	* `description`	仅供GitWeb 程序使用
	* `index`	保存了暂存区域信息
